<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sky.mapper.SetmealMapper">
  <sql id="query_setmeal">
    select id,
           name,
           category_id,
           price,
           image,
           description,
           status,
           create_time,
           update_time,
           create_user,
           update_user
    from setmeal
  </sql>
  <!--    修改套餐-->
  <update id="updateSetmeal">
    update setmeal
    <set>
      <if test="description != null">
        description = #{description},
      </if>
      category_id = #{categoryId},image = #{image},name = #{name},price = #{price}
      <where>
        id = #{id}
      </where>
    </set>
  </update>
  <!--    分页查询-->
  <select id="pageSetmeal" resultType="com.sky.entity.Setmeal">
    <include refid="query_setmeal"></include>
    <where>
      <if test="name != null">
        name like concat("%",#{name},"%")
      </if>
      <if test="categoryId != null">
        and category_id = #{categoryId}
      </if>
      <if test="status != null">
        and status = #{status}
      </if>
    </where>
  </select>
  <!--    //更改套餐状态-->
  <update id="updateSetmealStatus">
    update setmeal
    set status = #{status}
    where id = #{id}
  </update>
  <!--    批量删除套餐-->
  <delete id="deleteSetmals">
    delete from setmeal where id in
    <foreach item="id" index="index" collection="list" open="(" separator="," close=")">
      #{id}
    </foreach>
  </delete>
  <!--    新增套餐-->
  <insert id="addSetmeal">
    insert into setmeal (category_id, image, name, price, status, create_time, update_time, create_user, update_user)
    values (#{categoryId}, #{image}, #{name}, #{price}, #{status}, now(), now(), 1, 1)
  </insert>
  
  <!--查询单个-->
  <select id="getSetmealById" resultType="com.sky.entity.Setmeal">
    <include refid="query_setmeal" />
    <where>
      id = #{id}
    </where>
  </select>
</mapper>

